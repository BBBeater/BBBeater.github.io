<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Happy Anniversary - Advanced Edition</title>
<link href="https://fonts.googleapis.com/css2?family=Itim&display=swap" rel="stylesheet" />
<style>
  :root {
    --primary-color: #d43f6f; [cite: 1]
    --secondary-color: #f48fb1; [cite: 2]
    --light-pink-bg: #fff0f5; [cite: 2]
    --gradient-start: #ffd6e8; [cite: 2]
    --gradient-end: #fff0f5; [cite: 2]
    --border-color: #ffb6c1; [cite: 2]
    --shadow-color-light: rgba(244,143,177,0.5); [cite: 2]
    --shadow-color-dark: #ffb6c1; [cite: 2]
    --text-color: #5e2b45; [cite: 2]
    --card-bg: #fff0f8; [cite: 2]
  }

  @keyframes backgroundPan {
    0% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
    100% { background-position: 0% 50%; }
  }

  @keyframes fadeInUp {
    from { opacity: 0; transform: translateY(20px); }
    to { opacity: 1; transform: translateY(0); }
  }

  body {
    font-family: 'Itim', cursive;
    background: linear-gradient(135deg, #ffdee9, #ffc7d9, #fbcfe8, #f5d0fe); 
    background-size: 400% 400%;
    animation: backgroundPan 15s ease infinite;
    color: var(--text-color); 
    margin: 0; padding: 0; 
    display: flex; [cite: 4]
    justify-content: center; [cite: 4]
    align-items: center; [cite: 4]
    min-height: 100vh; [cite: 4]
  }

  button, input, select, textarea {
    font-family: inherit; [cite: 5]
  }

  .container {
    width: 95vw; [cite: 5]
    max-width: 600px; [cite: 5]
    background: rgba(255, 255, 255, 0.65);
    backdrop-filter: blur(12px);
    -webkit-backdrop-filter: blur(12px);
    border: 1px solid rgba(255, 255, 255, 0.2);
    border-radius: 25px; [cite: 5]
    box-shadow: 0 8px 32px 0 rgba(212, 63, 111, 0.3);
    padding: 35px 25px 40px; [cite: 6]
    text-align: center; [cite: 6]
    box-sizing: border-box; [cite: 6]
    position: relative; [cite: 6]
    overflow: hidden; [cite: 6]
  }

  .page {
    position: absolute;
    top: 0; left: 0; right: 0;
    padding: 35px 25px 40px;
    height: 100%;
    box-sizing: border-box;
    opacity: 0;
    visibility: hidden;
    transform: translateX(50px);
    transition: opacity 0.5s ease, transform 0.5s ease, visibility 0.5s;
  }
  .page.active {
    opacity: 1;
    visibility: visible;
    transform: translateX(0);
    position: relative;
  }
  .page.exit-left { transform: translateX(-50px); opacity: 0; visibility: hidden; }
  .page.exit-right { transform: translateX(50px); opacity: 0; visibility: hidden; }
  .page.enter-left { transform: translateX(-50px); }
  .page.enter-right { transform: translateX(50px); }

  h1, h2 { color: var(--primary-color); margin-bottom: 15px; [cite: 8] }
  p { font-size: 1.2rem; margin-bottom: 30px; line-height: 1.4; }

  input[type="password"], input[type="number"] {
    font-size: 20px; [cite: 9]
    padding: 10px 14px; [cite: 9]
    width: 150px; [cite: 9]
    border: 2px solid var(--border-color); [cite: 9]
    border-radius: 12px; [cite: 9]
    text-align: center; [cite: 9]
    margin-bottom: 15px; [cite: 9]
    letter-spacing: 0.2em; [cite: 9]
    background: rgba(255, 255, 255, 0.5);
  }

  button {
    background-color: var(--secondary-color); [cite: 11]
    border: none; [cite: 11]
    color: white; [cite: 11]
    font-size: 18px; [cite: 11]
    padding: 12px 28px; [cite: 11]
    border-radius: 20px; [cite: 11]
    cursor: pointer; [cite: 11]
    margin: 0 10px; [cite: 11]
    transition: background-color 0.3s ease, transform 0.2s ease; [cite: 11]
    box-shadow: 0 4px 10px var(--shadow-color-light); [cite: 12]
  }
  button:hover {
    background-color: var(--primary-color); [cite: 13]
    transform: translateY(-2px); [cite: 13]
  }
  button:active { transform: translateY(-2px) scale(0.95); }

  .buttons {
    display: flex; [cite: 14]
    justify-content: center; [cite: 14]
    align-items: center; [cite: 14]
    flex-wrap: wrap; [cite: 14]
    margin-top: 25px; [cite: 14]
    gap: 15px; [cite: 14]
  }

  #error { color: var(--primary-color); font-weight: bold; margin-top: 8px; }

  .menu-grid { display: grid; grid-template-columns: repeat(2, 1fr); [cite: 15] gap: 20px; justify-items: center; [cite: 15] }
  #categoryMenu .menu-card:nth-child(3) { grid-column: 1 / -1; }
  .menu-card { background: var(--card-bg); [cite: 16] border-radius: 20px; box-shadow: 0 0 12px var(--shadow-color-dark); cursor: pointer; padding: 15px; width: 140px; transition: transform 0.3s ease, box-shadow 0.3s ease; [cite: 16] user-select: none; [cite: 17] opacity: 0; animation: fadeInUp 0.5s ease forwards; }
  .menu-card.locked { cursor: default; opacity: 0.6; }
  .menu-card:hover:not(.locked) { transform: scale(1.07); [cite: 18] box-shadow: 0 0 20px var(--primary-color); [cite: 18] }
  .menu-card img { width: 80px; height: 80px; border-radius: 15px; margin-bottom: 10px; object-fit: cover; [cite: 19] user-select: none; [cite: 19] }
  .menu-card .title { font-weight: bold; color: var(--primary-color); }

  #gameMessage, #puzzleMessage { font-weight: bold; color: var(--primary-color); [cite: 20] min-height: 28px; margin-top: 15px; transition: color 0.3s ease; [cite: 20] }
  .back-game-menu-btn { background: #f8bbd0; color: #a6265a; border-radius: 25px; border: none; [cite: 21] padding: 8px 22px; cursor: pointer; font-weight: bold; margin: 0; box-shadow: 0 3px 8px rgba(248,187,208,0.6); [cite: 21] transition: background-color 0.3s ease, color 0.3s ease; [cite: 22] }
  .back-game-menu-btn:hover { background: var(--primary-color); color: white; [cite: 23] }

  #lightboxOverlay { position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(95, 35, 70, 0.9);  display: none; justify-content: center; align-items: center; z-index: 1000;  backdrop-filter: blur(5px); }
  #lightboxOverlay img { max-width: 90vw; max-height: 90vh; border-radius: 20px; [cite: 25] box-shadow: 0 0 25px var(--shadow-color-dark); cursor: zoom-out; user-select: none; [cite: 25] }

  #slideShow { position: relative; width: 100%; max-width: 420px; [cite: 26] height: 320px; margin: 0 auto 20px; border-radius: 25px; overflow: hidden; box-shadow: 0 0 15px var(--shadow-color-dark); [cite: 26] }
  #slideShow img { width: 100%; height: 320px; object-fit: cover; position: absolute; top: 0; left: 0; opacity: 0; [cite: 28] transition: opacity 0.6s ease; border-radius: 25px; user-select: none; [cite: 28] }
  #slideShow img.active { opacity: 1; position: relative; [cite: 29] }
  
  .slide-btn { position: absolute; top: 50%; transform: translateY(-50%); background: rgba(255, 255, 255, 0.5); backdrop-filter: blur(2px); [cite: 30] border: 1px solid rgba(255, 255, 255, 0.2); color: var(--primary-color); font-size: 24px; width: 48px; height: 48px; padding: 0; display: flex; [cite: 30] justify-content: center; align-items: center; border-radius: 50%; cursor: pointer; user-select: none; transition: background-color 0.3s ease, color 0.3s ease, transform 0.2s ease; [cite: 31] z-index: 10; [cite: 32] }
  .slide-btn:hover { background: var(--primary-color); color: white; transform: translateY(-50%); }
  #prevBtn { left: 15px; [cite: 33] }
  #nextBtn { right: 15px; }

  #slideCounter { margin: 0 auto 10px; font-weight: bold; color: var(--primary-color); [cite: 34] }
  #progressBar { width: 100%; max-width: 420px; height: 6px; background: #ffe4ef; border-radius: 6px; margin: 0 auto 30px; overflow: hidden; [cite: 35] }
  #progressBarInner { height: 100%; width: 0%; background: var(--primary-color); border-radius: 6px; transition: width 0.4s ease; [cite: 36] }
  
  #toast { position: fixed; top: -100px; left: 50%; transform: translateX(-50%); background-color: var(--primary-color); color: white; [cite: 37] padding: 16px 24px; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.2); z-index: 2000; font-size: 1.1rem; font-weight: bold; transition: top 0.5s ease-in-out; [cite: 37] }
  #toast.show { top: 20px; }

  #gacha-display { width: 100%; max-width: 200px; height: 100px; background: #fff9fb; border: 3px solid var(--border-color); border-radius: 20px; [cite: 43] margin: 20px auto; display: flex; justify-content: center; align-items: center; font-size: 4rem; color: var(--primary-color); box-shadow: inset 0 0 10px rgba(0,0,0,0.05); [cite: 43] }
  .numpad { display: grid; grid-template-columns: repeat(3, 1fr); [cite: 45] gap: 10px; max-width: 240px; margin: 20px auto 0; [cite: 45] }
  .numpad-btn { padding: 0; width: 60px; height: 60px; border-radius: 50%; [cite: 46] font-size: 1.5rem; margin: 0; [cite: 46] }
  .numpad-btn.special { background-color: #f8bbd0; color: #a6265a; [cite: 47] }

  #number-tracker { display: flex; flex-wrap: wrap; [cite: 48] justify-content: center; gap: 8px; max-width: 320px; margin: 20px auto; [cite: 48] }
  .tracker-num { width: 40px; height: 40px; background: #fff2f7; [cite: 49] border: 2px solid var(--border-color); border-radius: 50%; display: flex; justify-content: center; align-items: center; font-weight: bold; transition: background-color 0.3s, opacity 0.3s; [cite: 49] }
  .tracker-num.guessed { background-color: #e0e0e0; color: #9e9e9e; border-color: #ccc; }
  .tracker-num.correct { background-color: #a5d6a7; color: #1b5e20; border-color: #388e3c; [cite: 51] }
  
  #audio-toggle { position: absolute; top: 20px; right: 20px; background: rgba(255,255,255,0.5); color: var(--primary-color); border: 1px solid var(--border-color); width: 40px; height: 40px; padding: 0; border-radius: 50%; font-size: 1.2rem; z-index: 100; }
</style>
</head>
<body>

<div class="container">
  <button id="audio-toggle" type="button">üéµ</button>

  <div id="page0" class="page">
    <h1>üå∏ ‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö üå∏</h1>
    <p>‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏î‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô üíñ</p>
    <input type="password" id="password" readonly placeholder="****" />
    <div class="numpad" id="numpad-container"></div>
    <div class="buttons">
      <button type="button" data-sfx="click" onclick="App.checkPassword()">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡πÄ‡∏ß‡πá‡∏ö‡πÑ‡∏ã‡∏ï‡πå</button>
    </div>
    <p id="error"></p>
  </div>

  <div id="page1" class="page">
    <h1>‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡∏ß‡∏±‡∏ô‡∏Ñ‡∏£‡∏ö‡∏£‡∏≠‡∏ö‡∏Ç‡∏≠‡∏á‡πÄ‡∏£‡∏≤‡∏ô‡∏∞‡∏∞ üíï</h1>
    <div id="slideShow"></div>
    <div id="slideCounter"></div>
    <div id="progressBar"><div id="progressBarInner"></div></div>
    <button id="prevBtn" class="slide-btn" type="button" data-sfx="click">&#10094;</button>
    <button id="nextBtn" class="slide-btn" type="button" data-sfx="click">&#10095;</button>
    <div class="buttons">
      <button type="button" data-sfx="click" onclick="App.showPage('page0', 'left')">‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö</button>
      <button type="button" data-sfx="click" onclick="App.showPage('page2', 'right')">‡∏ñ‡∏±‡∏î‡πÑ‡∏õ</button>
    </div>
  </div>

  <div id="page2" class="page">
    <h2>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏°‡∏ß‡∏î‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏≤‡∏Å‡∏î‡∏π üíå</h2>
    <div class="menu-grid" id="categoryMenu"></div>
    <div class="buttons">
      <button type="button" data-sfx="click" onclick="App.showPage('page1', 'left')">‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö</button>
      <button type="button" data-sfx="click" onclick="App.showPage('page7', 'right')">‡πÑ‡∏õ‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏Å‡∏°‡∏õ‡∏•‡∏î‡∏•‡πá‡∏≠‡∏Ñ üîì</button>
    </div>
  </div>

  <div id="page3" class="page"><h2>The Best ‡∏Ç‡∏≠‡∏á‡∏ó‡∏∏‡∏Å‡πÄ‡∏î‡∏∑‡∏≠‡∏ô üíñ</h2><div class="menu-grid" id="bestGrid"></div><div class="buttons"><button data-sfx="click" onclick="App.showPage('page2', 'left')">‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö</button></div></div>
  <div id="page4" class="page"><h2>‡∏£‡∏π‡∏õ‡∏ó‡∏µ‡πà‡∏Æ‡∏≤‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡∏Ç‡∏≠‡∏á‡πÄ‡∏£‡∏≤ üòÇ</h2><div class="menu-grid" id="funnyGrid"></div><div class="buttons"><button data-sfx="click" onclick="App.showPage('page2', 'left')">‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö</button></div></div>
  <div id="page5" class="page"><h2>‡∏£‡∏π‡∏õ‡πÅ‡∏≠‡∏ö‡∏ñ‡πà‡∏≤‡∏¢ üì∏</h2><div class="menu-grid" id="secretGrid"></div><div class="buttons"><button data-sfx="click" onclick="App.showPage('page2', 'left')">‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö</button></div></div>
  <div id="page6" class="page"><h2>‡∏£‡∏π‡∏õ‡∏ó‡∏µ‡πà‡∏ä‡∏≠‡∏ö‡∏Å‡∏±‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏Ñ‡∏π‡πà üíû</h2><div class="menu-grid" id="loveGrid"></div><div class="buttons"><button data-sfx="click" onclick="App.showPage('page2', 'left')">‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö</button></div></div>
  
  <div id="page8" class="page">
      <h2>‡∏ñ‡∏∂‡∏á‡∏Ñ‡∏ô‡∏î‡∏µ‡∏Ç‡∏≠‡∏á‡πÄ‡∏Ñ‡πâ‡∏≤ üíå</h2>
      <p style="text-align: left; background: #fff9fb; padding: 20px; border-radius: 15px; border: 1px solid var(--border-color);">
        ‡∏™‡∏∏‡∏Ç‡∏™‡∏±‡∏ô‡∏ï‡πå‡∏ß‡∏±‡∏ô‡∏Ñ‡∏£‡∏ö‡∏£‡∏≠‡∏ö‡∏ô‡∏∞! ‡πÑ‡∏°‡πà‡∏ô‡πà‡∏≤‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏•‡∏¢‡∏ß‡πà‡∏≤‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡∏ú‡πà‡∏≤‡∏ô‡∏≠‡∏∞‡πÑ‡∏£‡∏î‡πâ‡∏ß‡∏¢‡∏Å‡∏±‡∏ô‡∏°‡∏≤‡πÄ‡∏¢‡∏≠‡∏∞‡∏Ç‡∏ô‡∏≤‡∏î‡∏ô‡∏µ‡πâ...<br><br>
        ‡∏ó‡∏∏‡∏Å‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏°‡∏µ‡πÄ‡∏ò‡∏≠‡∏≠‡∏¢‡∏π‡πà‡∏Ç‡πâ‡∏≤‡∏á‡πÜ ‡∏Ñ‡∏∑‡∏≠‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏î‡∏µ‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡πÄ‡∏•‡∏¢ ‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ó‡∏∏‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡∏∞ ‡∏£‡∏±‡∏Å‡∏°‡∏≤‡∏Å‡πÜ‡πÄ‡∏•‡∏¢‡∏Ñ‡πâ‡∏≤‡∏ö üíñ
        <br><br>
        ‡∏à‡∏≤‡∏Å... ‡∏Ñ‡∏ô‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏Å‡πÄ‡∏ò‡∏≠‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡πÉ‡∏ô‡πÇ‡∏•‡∏Å
      </p>
      <div class="buttons"><button data-sfx="click" onclick="App.showPage('page2', 'left')">‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡πÄ‡∏°‡∏ô‡∏π</button></div>
  </div>

  <div id="page7" class="page">
    <h2>üéÆ ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏Å‡∏°‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏õ‡∏•‡∏î‡∏•‡πá‡∏≠‡∏Ñ! üéÆ</h2>
    <div class="menu-grid" id="gameMenuGrid"></div>
    <div class="buttons"><button data-sfx="click" onclick="App.showPage('page2', 'left')">‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö</button></div>
  </div>

  <div id="gameGuessNumber" class="page">
    <h2>‡πÄ‡∏Å‡∏°‡∏ó‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç (1-10)</h2><p>‡∏•‡∏≠‡∏á‡∏ó‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡∏â‡∏±‡∏ô‡∏Ñ‡∏¥‡∏î‡∏≠‡∏¢‡∏π‡πà‡∏™‡∏¥! üé≤</p>
    <div id="number-tracker"></div>
    <input type="number" id="guessInput" min="1" max="10" />
    <div id="gameMessage"></div>
    <div class="buttons">
        <button type="button" data-sfx="click" onclick="GameController.checkGuess()">‡∏ó‡∏≤‡∏¢!</button>
        <button type="button" data-sfx="click" class="back-game-menu-btn" onclick="App.showPage('page7', 'left')">‡∏Å‡∏•‡∏±‡∏ö</button>
    </div>
  </div>

  <div id="gameCardShuffle" class="page">
    <h2>‡πÄ‡∏Å‡∏°‡∏´‡∏≤‡πÑ‡∏û‡πà‡∏´‡∏±‡∏ß‡πÉ‡∏à üÉè</h2><p>‡∏Ñ‡∏•‡∏¥‡∏Å‡πÑ‡∏û‡πà‡∏´‡∏≤‡∏´‡∏±‡∏ß‡πÉ‡∏à‡πÉ‡∏ô 3 ‡πÉ‡∏ö‡∏ô‡∏µ‡πâ‡πÉ‡∏´‡πâ‡πÄ‡∏à‡∏≠! ‚ô•Ô∏è</p>
    <div id="cardContainer" style="display:flex; justify-content:center; gap:20px; margin: 25px 0;"></div>
    <div id="puzzleMessage"></div>
    <div class="buttons">
        <button type="button" data-sfx="click" onclick="GameController.startCardGame()">‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà</button>
        <button type="button" data-sfx="click" class="back-game-menu-btn" onclick="App.showPage('page7', 'left')">‡∏Å‡∏•‡∏±‡∏ö</button>
    </div>
  </div>

  <div id="gameGacha" class="page">
    <h2>‡∏Å‡∏≤‡∏ä‡∏≤‡∏î‡∏≤‡∏ß 5 ‚≠ê</h2><p>‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡∏∏‡πà‡∏°‡∏î‡∏≤‡∏ß ‡∏£‡∏±‡∏ö‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏û‡∏¥‡πÄ‡∏®‡∏©!</p>
    <div id="gacha-display">üé∞</div>
    <div id="gachaResult" style="margin-top: 10px; font-weight: bold; color: var(--primary-color); min-height: 28px;"></div>
    <div class="buttons">
        <button type="button" data-sfx="click" onclick="GameController.startGacha()">‡∏Å‡∏î‡∏™‡∏∏‡πà‡∏°</button>
        <button type="button" data-sfx="click" class="back-game-menu-btn" onclick="App.showPage('page7', 'left')">‡∏Å‡∏•‡∏±‡∏ö</button>
    </div>
  </div>
  
  <div id="gameShootHearts" class="page">
    <h2>‡∏¢‡∏¥‡∏á‡∏´‡∏±‡∏ß‡πÉ‡∏à‡∏•‡∏á‡∏´‡πà‡∏ß‡∏á üíò</h2>
    <p>‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏° '‡∏¢‡∏¥‡∏á' ‡∏Ñ‡πâ‡∏≤‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ä‡∏≤‡∏£‡πå‡∏à‡∏û‡∏•‡∏±‡∏á‡πÅ‡∏•‡πâ‡∏ß‡∏õ‡∏•‡πà‡∏≠‡∏¢!</p>
    <div style="position: relative; margin: 20px auto; width: 320px; height: 280px; background: #ffe4ef; border-radius: 25px; box-shadow: 0 0 15px #ffb6c1;">
      <div id="hoop" style="position: absolute; width: 100px; height: 20px; background: #ff69b4; border-radius: 10px; top: 80px; left: 50%; transform: translateX(-50%);"></div>
      <div id="heart" style="position: absolute; width: 40px; height: 40px; background: red; top: 220px; left: 50%; transform: translateX(-50%); border-radius: 50%; box-shadow: 0 0 10px #ff8ab8;"></div>
    </div>
    <p id="shootMessage" style="margin-top: 18px; font-weight: bold; color: var(--primary-color); min-height: 28px;"></p>
    <div class="buttons">
      <button type="button" id="shootBtn">‚ù§Ô∏è ‡∏¢‡∏¥‡∏á!</button>
      <button type="button" data-sfx="click" class="back-game-menu-btn" onclick="App.showPage('page7', 'left')">‡∏Å‡∏•‡∏±‡∏ö</button>
    </div>
  </div>

  <div id="lightboxOverlay"><img id="lightboxImage" src="" alt="‡∏Ç‡∏¢‡∏≤‡∏¢‡∏£‡∏π‡∏õ" /></div>
  <div id="toast"></div>
</div>

<audio id="audio-bg" src="PATH_TO_YOUR/background-music.mp3" loop></audio>
<audio id="audio-click" src="PATH_TO_YOUR/click.mp3"></audio>
<audio id="audio-success" src="PATH_TO_YOUR/success.mp3"></audio>
<audio id="audio-error" src="PATH_TO_YOUR/error.mp3"></audio>

<script>
document.addEventListener('DOMContentLoaded', () => {

    const App = {
        config: {
            password: "0000",
            slides: [
                { src: "https://images.unsplash.com/photo-1503023345310-bd7c1de61c7d?auto=format&fit=crop&w=600&q=80", alt: "‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏°" },
                { src: "https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=600&q=80", alt: "‡∏Å‡∏∏‡∏°‡∏†‡∏≤‡∏û‡∏±‡∏ô‡∏ò‡πå" },
                { src: "https://images.unsplash.com/photo-1518709268805-4e9042af9f23?auto=format&fit=crop&w=600&q=80", alt: "‡∏°‡∏µ‡∏ô‡∏≤‡∏Ñ‡∏°" },
                { src: "https://images.unsplash.com/photo-1500534623283-312aade485b7?auto=format&fit=crop&w=600&q=80", alt: "‡πÄ‡∏°‡∏©‡∏≤‡∏¢‡∏ô" },
            ],
            photos: {
                best: ["https://images.unsplash.com/photo-1517816743773-6e0fd518b4a6?auto=format&fit=crop&w=400&q=80", "https://images.unsplash.com/photo-1529626455594-4ff0802cfb7e?auto=format&fit=crop&w=400&q=80"],
                funny: ["https://images.unsplash.com/photo-1508214751196-bcfd4ca60f91?auto=format&fit=crop&w=400&q=80"],
                secret: ["https://images.unsplash.com/photo-1529626455594-4ff0802cfb7e?auto=format&fit=crop&w=400&q=80"],
                love: ["https://images.unsplash.com/photo-1494790108377-be9c29b29330?auto=format&fit=crop&w=400&q=80"],
            },
        },
        state: {
            currentPageId: null,
            currentSlideIndex: 0,
            unlocked: { best: false, funny: false, secret: false, love: false, letter: false },
        },
        init() {
            this.loadState();
            UI.init();
            AudioController.init();
            GameController.init();
            this.showPage('page0', 'right', true);
        },
        loadState() {
            const savedState = localStorage.getItem('anniversaryAppState');
            if (savedState) {
                this.state.unlocked = JSON.parse(savedState);
            }
        },
        saveState() {
            localStorage.setItem('anniversaryAppState', JSON.stringify(this.state.unlocked));
        },
        showPage(id, direction = 'right', isFirstLoad = false) {
            const newPage = document.getElementById(id);
            const oldPage = this.state.currentPageId ? document.getElementById(this.state.currentPageId) : null;

            if (oldPage === newPage) return;

            if (oldPage) {
                oldPage.classList.add(direction === 'right' ? 'exit-left' : 'exit-right');
            }

            newPage.classList.remove('exit-left', 'exit-right', 'enter-left', 'enter-right');
            newPage.classList.add('page', isFirstLoad ? '' : (direction === 'right' ? 'enter-right' : 'enter-left'));
            
            // Force reflow for transition
            newPage.getBoundingClientRect();
            
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            newPage.classList.add('active');
            
            this.state.currentPageId = id;
            this.onPageLoad(id);
        },
        onPageLoad(id) {
            if (id === 'page1') UI.updateSlideShow();
            if (id === 'page2') UI.updateCategoryLocks();
            if (id.startsWith('game')) GameController.onGamePageLoad(id);
            UI.staggerMenuItems(`#${id} .menu-card`);
        },
        checkPassword() {
            const pwInput = UI.elements.passwordInput;
            if (pwInput.value === this.config.password) {
                AudioController.play('success');
                this.showPage("page1", 'right');
                UI.elements.errorMsg.textContent = "";
                pwInput.value = "";
            } else {
                AudioController.play('error');
                UI.elements.errorMsg.textContent = "‡∏£‡∏´‡∏±‡∏™‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á ‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ô‡∏∞!";
            }
        },
        unlockCategory(cat) {
            if (!this.state.unlocked[cat]) {
                AudioController.play('success');
                this.state.unlocked[cat] = true;
                this.saveState();
                UI.showToast(`üéâ ‡∏´‡∏°‡∏ß‡∏î '${cat}' ‡∏ñ‡∏π‡∏Å‡∏õ‡∏•‡∏î‡∏•‡πá‡∏≠‡∏Ñ‡πÅ‡∏•‡πâ‡∏ß!`);
                setTimeout(() => this.showPage("page2", 'left'), 500);
            }
        },
    };

    const UI = {
        elements: {
            passwordInput: document.getElementById('password'),
            errorMsg: document.getElementById('error'),
            slideShowContainer: document.getElementById('slideShow'),
            slideCounter: document.getElementById('slideCounter'),
            progressBarInner: document.getElementById('progressBarInner'),
            lightboxOverlay: document.getElementById('lightboxOverlay'),
            lightboxImage: document.getElementById('lightboxImage'),
            toast: document.getElementById('toast'),
            numpadContainer: document.getElementById('numpad-container'),
            categoryMenu: document.getElementById('categoryMenu'),
            gameMenuGrid: document.getElementById('gameMenuGrid'),
        },
        init() {
            this.setupSlideshow();
            this.generateNumpad();
            this.generateMenus();
            this.elements.lightboxOverlay.onclick = () => this.elements.lightboxOverlay.style.display = "none";
            document.getElementById('prevBtn').onclick = () => this.changeSlide(-1);
            document.getElementById('nextBtn').onclick = () => this.changeSlide(1);
        },
        setupSlideshow() {
            this.elements.slideShowContainer.innerHTML = App.config.slides.map((slide, index) =>
                `<img src="${slide.src}" alt="${slide.alt}" class="${index === 0 ? 'active' : ''}" />`
            ).join('');
            this.elements.slideImages = this.elements.slideShowContainer.querySelectorAll('img');
        },
        changeSlide(dir) {
            App.state.currentSlideIndex = (App.state.currentSlideIndex + dir + this.elements.slideImages.length) % this.elements.slideImages.length;
            this.updateSlideShow();
        },
        updateSlideShow() {
            this.elements.slideImages.forEach((img, i) => {
                img.classList.toggle("active", i === App.state.currentSlideIndex);
            });
            const totalSlides = this.elements.slideImages.length;
            this.elements.slideCounter.textContent = `‡∏£‡∏π‡∏õ‡∏ó‡∏µ‡πà ${App.state.currentSlideIndex + 1} / ${totalSlides}`;
            this.elements.progressBarInner.style.width = `${((App.state.currentSlideIndex + 1) / totalSlides) * 100}%`;
        },
        generateNumpad() {
            const buttons = [ '1', '2', '3', '4', '5', '6', '7', '8', '9', 'C', '0', '‚Üê' ];
            buttons.forEach(val => {
                const btn = document.createElement('button');
                btn.type = 'button';
                btn.className = 'numpad-btn';
                if (isNaN(val)) btn.classList.add('special');
                btn.textContent = val;
                btn.dataset.sfx = 'click';
                btn.onclick = () => {
                    const pwInput = this.elements.passwordInput;
                    if (val === 'C') pwInput.value = '';
                    else if (val === '‚Üê') pwInput.value = pwInput.value.slice(0, -1);
                    else if (pwInput.value.length < 4) pwInput.value += val;
                };
                this.elements.numpadContainer.appendChild(btn);
            });
        },
        generateMenus() {
            const categoryData = [
                { category: 'best', imgText: 'Best', title: 'The Best ‡∏Ç‡∏≠‡∏á‡∏ó‡∏∏‡∏Å‡πÄ‡∏î‡∏∑‡∏≠‡∏ô' },
                { category: 'funny', imgText: 'Funny', title: '‡∏£‡∏π‡∏õ‡∏ó‡∏µ‡πà‡∏Æ‡∏≤‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡∏Ç‡∏≠‡∏á‡πÄ‡∏£‡∏≤' },
                { category: 'letter', imgText: 'üìú', title: '‡∏à‡∏î‡∏´‡∏°‡∏≤‡∏¢‡∏•‡∏±‡∏ö', special: true },
                { category: 'secret', imgText: 'Secret', title: '‡∏£‡∏π‡∏õ‡πÅ‡∏≠‡∏ö‡∏ñ‡πà‡∏≤‡∏¢' },
                { category: 'love', imgText: 'Love', title: '‡∏£‡∏π‡∏õ‡∏ó‡∏µ‡πà‡∏ä‡∏≠‡∏ö‡∏Å‡∏±‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏Ñ‡∏π‡πà' },
            ];
            const gameData = [
                { game: 'guessNumber', title: '‡πÄ‡∏Å‡∏°‡∏ó‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç üé≤', page: 'gameGuessNumber' },
                { game: 'cardShuffle', title: '‡πÄ‡∏Å‡∏°‡∏´‡∏≤‡πÑ‡∏û‡πà‡∏´‡∏±‡∏ß‡πÉ‡∏à üÉè', page: 'gameCardShuffle' },
                { game: 'gachaPull', title: '‡∏Å‡∏≤‡∏ä‡∏≤‡∏î‡∏≤‡∏ß 5 ‚≠ê', page: 'gameGacha' },
                { game: 'shootHearts', title: '‡∏¢‡∏¥‡∏á‡∏´‡∏±‡∏ß‡πÉ‡∏à‡∏•‡∏á‡∏´‡πà‡∏ß‡∏á üíò', page: 'gameShootHearts' },
            ];

            this.elements.categoryMenu.innerHTML = categoryData.map(item => this.createMenuCard(item)).join('');
            this.elements.gameMenuGrid.innerHTML = gameData.map(item => this.createMenuCard(item)).join('');
            this.updateCategoryLocks();
        },
        createMenuCard(item) {
            const isGame = !!item.game;
            const action = isGame
                ? `onclick="App.showPage('${item.page}', 'right')"`
                : `data-category="${item.category}"`;
            const smallText = item.special ? 'üîí ‡∏õ‡∏•‡∏î‡∏•‡πá‡∏≠‡∏Ñ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏Å‡πà‡∏≠‡∏ô' : 'üîí ‡∏ï‡πâ‡∏≠‡∏á‡∏õ‡∏•‡∏î‡∏•‡πá‡∏≠‡∏Ñ‡∏Å‡πà‡∏≠‡∏ô';
            return `
                <div class="menu-card" data-sfx="click" ${action}>
                    <img src="https://via.placeholder.com/80/f7b6cc/fff?text=${item.imgText || item.game}" alt="${item.title}" />
                    <div class="title">${item.title}</div>
                    ${isGame ? '' : `<small>${smallText}</small>`}
                </div>`;
        },
        updateCategoryLocks() {
            const allUnlocked = App.state.unlocked.best && App.state.unlocked.funny && App.state.unlocked.secret && App.state.unlocked.love;
            if (allUnlocked && !App.state.unlocked.letter) {
                App.state.unlocked.letter = true;
                App.saveState();
            }
            
            this.elements.categoryMenu.querySelectorAll(".menu-card").forEach(card => {
                const cat = card.dataset.category;
                if (!cat) return;
                
                const pageMap = { best: 'page3', funny: 'page4', secret: 'page5', love: 'page6', letter: 'page8' };
                if (App.state.unlocked[cat]) {
                    card.classList.remove("locked");
                    card.querySelector("small").textContent = "üîì ‡∏õ‡∏•‡∏î‡∏•‡πá‡∏≠‡∏Ñ‡πÅ‡∏•‡πâ‡∏ß";
                    card.style.opacity = "1";
                    card.onclick = () => App.showPage(pageMap[cat], 'right');
                } else {
                    card.classList.add("locked");
                    card.style.opacity = "0.6";
                    card.onclick = null;
                }
            });
        },
        staggerMenuItems(selector) {
            document.querySelectorAll(selector).forEach((card, index) => {
                card.style.animationDelay = `${index * 0.07}s`;
            });
        },
        showToast(message) {
            this.elements.toast.textContent = message;
            this.elements.toast.classList.add('show');
            setTimeout(() => {
                this.elements.toast.classList.remove('show');
            }, 3000);
        },
    };

    const AudioController = {
        isMuted: false,
        elements: {},
        init() {
            this.elements.bg = document.getElementById('audio-bg');
            this.elements.click = document.getElementById('audio-click');
            this.elements.success = document.getElementById('audio-success');
            this.elements.error = document.getElementById('audio-error');
            this.elements.toggleBtn = document.getElementById('audio-toggle');
            this.elements.toggleBtn.onclick = () => this.toggleMusic();
            document.body.addEventListener('click', (e) => {
                if(e.target.closest('[data-sfx="click"]')) this.play('click');
            }, true);
        },
        play(sound) {
            if (this.isMuted || !this.elements[sound]) return;
            this.elements[sound].currentTime = 0;
            this.elements[sound].play().catch(() => {});
        },
        toggleMusic() {
            this.isMuted = !this.isMuted;
            if (this.isMuted) {
                this.elements.bg.pause();
                this.elements.toggleBtn.textContent = 'üîá';
            } else {
                this.elements.bg.play().catch(() => {});
                this.elements.toggleBtn.textContent = 'üéµ';
            }
        },
    };

    const GameController = {
        state: {},
        elements: {},
        init() {
            // Cache game-specific elements here if needed
        },
        onGamePageLoad(id) {
            const gameMap = {
                gameGuessNumber: this.startGuessNumberGame,
                gameCardShuffle: this.startCardShuffleGame,
                gameGacha: this.startGacha,
                gameShootHearts: this.startShootHeartGame,
            };
            if(gameMap[id]) gameMap[id]();
        },
        startGuessNumberGame() {
            GameController.state.targetNumber = Math.floor(Math.random() * 10) + 1;
            const tracker = document.getElementById('number-tracker');
            tracker.innerHTML = '';
            for (let i = 1; i <= 10; i++) {
                tracker.innerHTML += `<div class="tracker-num" data-num="${i}">${i}</div>`;
            }
            document.getElementById("gameMessage").textContent = "";
            document.getElementById("guessInput").value = "";
        },
        checkGuess() {
            const input = document.getElementById("guessInput");
            const message = document.getElementById("gameMessage");
            const val = parseInt(input.value);
            if (!val || val < 1 || val > 10) {
                message.textContent = "‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏•‡∏Ç 1-10 ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô‡∏ô‡∏∞!";
                return;
            }
            const guessedNumEl = document.querySelector(`.tracker-num[data-num="${val}"]`);
            if (val === GameController.state.targetNumber) {
                message.textContent = "üéâ ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á!";
                if(guessedNumEl) guessedNumEl.classList.add('correct');
                App.unlockCategory("best");
            } else {
                AudioController.play('error');
                message.textContent = "‡∏ú‡∏¥‡∏î‡∏ô‡∏∞ ‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á!";
                if(guessedNumEl) guessedNumEl.classList.add('guessed');
            }
        },
        startCardShuffleGame() {
            // Implementation for card shuffle game
        },
        startGacha() {
             const gachaPool = [ { emoji: 'üå∏', stars: 1 }, { emoji: 'üçÄ', stars: 2 }, { emoji: '‚ù§Ô∏è', stars: 3 }, { emoji: '‚ú®', stars: 4 }, { emoji: 'üåü', stars: 5 } ];
             const display = document.getElementById("gacha-display"); const resultDiv = document.getElementById("gachaResult"); resultDiv.textContent = ""; display.textContent = "üé∞"; let spinCount = 0; const spinInterval = setInterval(() => { display.textContent = gachaPool[Math.floor(Math.random() * gachaPool.length)].emoji; spinCount++; if (spinCount >= 15) { clearInterval(spinInterval); const result = gachaPool[Math.floor(Math.random() * gachaPool.length)]; display.textContent = result.emoji; let starText = "‚≠ê".repeat(result.stars); resultDiv.textContent = `‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏î‡πâ '${result.emoji}' ‡∏£‡∏∞‡∏î‡∏±‡∏ö ${result.stars} ‡∏î‡∏≤‡∏ß! ${starText}`; if (result.stars === 5) { resultDiv.textContent += " üíñ ‡∏õ‡∏•‡∏î‡∏•‡πá‡∏≠‡∏Ñ‡∏´‡∏°‡∏ß‡∏î‡∏£‡∏π‡∏õ‡πÅ‡∏≠‡∏ö‡∏ñ‡πà‡∏≤‡∏¢‡πÅ‡∏•‡πâ‡∏ß!"; App.unlockCategory("secret"); } } }, 120);
        },
        startShootHeartGame() {
            // Implementation for shooting heart game
        },
    };

    // Make some methods globally accessible for inline onclicks
    window.App = App;
    window.GameController = GameController;

    App.init();
});
</script>
</body>
</html>
